import jax
import jax.numpy as jnp
from jax import vmap
import qnm

jax.config.update("jax_enable_x64", True)


def _to_jnp(arr):
    return jnp.array(arr, dtype=jnp.float64)


# KN Shift fits
a_omega = [
    _to_jnp(x)
    for x in [[
        -23.568201156037464, 23.951197345134734, -0.012188725394500952,
        -0.4403760814745556, 0.0953866672770307
    ],
              [
                  -635.1380838265326, 675.3218410940627, -43.83297192527946,
                  3.6781878794793186, -0.0022589861625467085
              ],
              [
                  -38060.8266288415, 41873.058521999716, -4601.338821353133,
                  904.0620229605345, -114.92755993227574
              ],
              [
                  -42138.47758072529, 46407.80877507778, -5159.56860362523,
                  1020.4750794973268, -130.20906660097833
              ],
              [
                  -455.21034206019436, 1052.2949325728603, -836.4616580416196,
                  290.9504520734289, -51.54384588166084
              ],
              [
                  -1685.8440375525024, 2312.717307107109, -866.4037059330217,
                  291.81911993342777, -52.257874800158994
              ],
              [
                  -3951.567910421205, 4754.3575879654145, -1067.3444576602758,
                  319.46937852861356, -54.88209987556748
              ],
              [
                  -95852.29427496661, 105343.03263702817, -11430.008155194215,
                  2217.914963353805, -278.6051646455483
              ],
              [
                  -87158.34237829434, 95913.47187700581, -10569.725836252179,
                  2078.8738646263887, -264.2363665591479
              ],
              [
                  -1024614.9010694753, 1118292.0416320618, -111172.62853649694,
                  19777.306491939875, -2281.778243174738
              ],
              [
                  -5551.851396191005, 9218.850826634656, -4969.603989512811,
                  1554.516943227445, -251.86952213358384
              ],
              [
                  -89262.68329717578, 98159.09808350241, -10726.918626389994,
                  2095.3960766520886, -264.84129628839247
              ],
              [
                  14455.770229971127, -2139.0820262771053, -17421.363258514644,
                  6145.212950251165, -1040.4879403889106
              ]]
]
a_gamma = [
    _to_jnp(x)
    for x in [[
        -107.52720159553671, 118.59333351602986, -13.245734163655987,
        2.459895033250609, -0.28311693222581963
    ],
              [
                  -1622.7641730375176, 1781.678478023459, -189.58237887922039,
                  34.65559726233537, -3.9955492754598976
              ],
              [
                  -539.826490017894, 592.63632193912, -63.36451262132204,
                  12.02725698869976, -1.475377522430351
              ],
              [
                  2121.7512156576468, -2217.430917174396, 95.91935904706484,
                  1.9168121838588812, -2.1643506563482044
              ],
              [
                  9973.067099807766, -10456.014538572534, 490.763677977777,
                  1.6411234101797987, -9.460291435370323
              ],
              [
                  36017.81489595915, -39110.36180132478, 3632.0909360303503,
                  -604.9402008351675, 65.38850568087685
              ],
              [
                  -35289.904772025126, 38741.85207004186, -4141.789523520907,
                  785.817897005727, -95.98641412908916
              ],
              [
                  -5462.414709896077, 5961.181626517315, -591.872885926749,
                  105.24632318171302, -12.14241505205305
              ],
              [
                  -7000.439508755772, 7650.860273993333, -775.5094953946867,
                  142.06699522366682, -16.984182996466473
              ],
              [
                  -294.8585341609884, 319.7579736001421, -14.568064205481555,
                  -14.810257149162071, 4.476910858515943
              ],
              [
                  112515.4304270477, -118980.21728646218, 6993.508209790105,
                  -518.1078253605477, -10.61995928514181
              ],
              [
                  -313.7249093092776, 373.61160875504584, -77.36733373920445,
                  20.5575696799064, -3.0788364476615735
              ],
              [
                  1052057.091899247, -1150845.6296044004, 117659.44384495965,
                  -21371.65896409622, 2500.7536198181842
              ]]
]
b_omega = [
    _to_jnp(x)
    for x in [[
        -23.057941419009367, -10.727285001111717, -2.9826774039663886,
        -0.489083720866339, -0.0368970499213642
    ],
              [
                  -598.7733326831025, -266.52921738672904, -70.53545043946633,
                  -11.06767600414148, -0.811304664437551
              ],
              [
                  -34923.20751255975, -14884.411486145627, -3695.689898638174,
                  -533.2433781941342, -35.43985877759116
              ],
              [
                  -38629.65799277464, -16437.170794414964, -4069.2874837487175,
                  -584.10658255536, -38.44810595021396
              ],
              [
                  -46.679043901173436, 247.3775228443203, 167.8484142199745,
                  47.68381292245684, 5.400016305201266
              ],
              [
                  -1247.0279625607106, -321.4922125403504,
                  -0.10793438617261551, 16.29199560696841, 2.4503091482645027
              ],
              [
                  -3359.3259238129144, -1244.2680247529825, -236.9887955736587,
                  -19.096768268179105, 0.06228055264391393
              ],
              [
                  -88023.0343333301, -37567.00349731226, -9347.314504813308,
                  -1352.746449177809, -90.25968176834243
              ],
              [
                  -79954.42190255031, -34062.17459963062, -8450.67837897461,
                  -1217.5614656878545, -80.71622477225213
              ],
              [
                  -946152.8519775195, -407555.1528439805, -102890.16768085156,
                  -15210.216342097474, -1044.346943306335
              ],
              [
                  -2936.811205973112, 343.44711625752495, 746.5264334215759,
                  260.0340726888342, 32.5115518499918
              ],
              [
                  -81932.79674627107, -34940.06041629319, -8682.742123408203,
                  -1254.2758677643715, -83.48668192251895
              ],
              [
                  22706.12973758486, 16563.779706272595, 6902.332077339708,
                  1613.752480568277, 165.71309589750027
              ]]
]
b_gamma = [
    _to_jnp(x)
    for x in [[
        -98.36252561706061, -41.59121208731333, -10.16030344009708,
        -1.423691709008511, -0.0903231066152307
    ],
              [
                  -1490.5445519150426, -635.6051945511043, -157.58314989872974,
                  -22.601509158863372, -1.4821347870098032
              ],
              [
                  -496.10570618234357, -211.88284379004168, -52.78145437717657,
                  -7.612408730407225, -0.49839551849618063
              ],
              [
                  2028.428530696987, 925.5610198247651, 255.40037675067373,
                  42.99050585316767, 3.511599178924789
              ],
              [
                  9507.365505574591, 4314.451607289894, 1179.181299200342,
                  194.74438384610477, 15.377089148482991
              ],
              [
                  33399.368507946674, 14490.221949852896, 3700.8122195761493,
                  556.9893776521563, 39.2376764871023
              ],
              [
                  -32432.003116400607, -13856.463266623843, -3452.727562760565,
                  -500.39720732802925, -33.445778876885285
              ],
              [
                  -5044.630414805016, -2173.3209076162125, -548.8976369821531,
                  -81.18559020006944, -5.581507329828148
              ],
              [
                  -6458.18713987735, -2777.8461906030366, -700.2830789549455,
                  -103.39665060760711, -7.118321912075768
              ],
              [
                  -264.11952088386585, -99.73298180856388, -13.97308985719979,
                  2.523325506918454, 0.9149014416868452
              ],
              [
                  106589.82533605814, 47917.8405991453, 12936.479385653485,
                  2107.6876119239723, 164.40934897658522
              ],
              [
                  -268.25665221523093, -99.9354912157314, -19.030470031080434,
                  -1.4602418953957226, 0.02660957828972295
              ],
              [
                  969639.0663923781, 416279.4014975687, 104504.50338066777,
                  15312.149686103674, 1037.7429037268435
              ]]
]